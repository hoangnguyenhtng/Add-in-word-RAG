<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>RAG Chat Assistant</title>
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self' https://appsforoffice.microsoft.com;
                 connect-src 'self' https://localhost:8000 http://localhost:8000;">
  <link rel="stylesheet" href="/taskpane.css"/>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script defer src="/taskpane.js"></script>
</head>
<body>
  <div id="app">
    <header>
      <h1>Word RAG Chat</h1>
      <div class="tabs">
        <button class="tab active" data-tab="chat">ğŸ’¬ Chat</button>
        <button class="tab" data-tab="manage">ğŸ“š Quáº£n lÃ½ KB</button>
      </div>
    </header>

    <div id="tab-chat" class="tab-content active">
      <section class="options">
        <label><input type="radio" name="scope" value="selection" checked> Chá»‰ vÃ¹ng bÃ´i Ä‘en</label>
        <label><input type="radio" name="scope" value="document"> ToÃ n bá»™ tÃ i liá»‡u</label>
        <label class="switch">
          <input type="checkbox" id="use-kb" checked>
          <span>ğŸ” TÃ¬m trong kho dá»¯ liá»‡u</span>
        </label>
        <label class="switch">
          <input type="checkbox" id="with-citations" checked>
          <span>ğŸ“ Tráº£ vá» kÃ¨m tham chiáº¿u</span>
        </label>
      </section>

      <div id="chat"></div>

      <form id="composer">
        <input id="question" placeholder="Äáº·t cÃ¢u há»i vá» tÃ i liá»‡uâ€¦"/>
        <button type="submit">Há»i</button>
      </form>
    </div>

    <div id="tab-manage" class="tab-content">
      <section class="kb-section">
        <h2>LÆ°u tÃ i liá»‡u vÃ o kho</h2>
        <div class="kb-form">
          <label>
            TiÃªu Ä‘á» tÃ i liá»‡u:
            <input type="text" id="doc-title" placeholder="VÃ­ dá»¥: Luáº­t An toÃ n giao thÃ´ng 2024"/>
          </label>
          <label>
            Loáº¡i tÃ i liá»‡u:
            <select id="doc-type">
              <option value="law">VÄƒn báº£n phÃ¡p luáº­t</option>
              <option value="contract">Há»£p Ä‘á»“ng</option>
              <option value="policy">ChÃ­nh sÃ¡ch</option>
              <option value="report">BÃ¡o cÃ¡o</option>
              <option value="other">KhÃ¡c</option>
            </select>
          </label>
          <label>
            NgÃ y ban hÃ nh (tÃ¹y chá»n):
            <input type="date" id="doc-date"/>
          </label>
          <div class="kb-actions">
            <button id="index-current-doc" class="btn-primary">ğŸ“¤ LÆ°u tÃ i liá»‡u hiá»‡n táº¡i</button>
            <button id="index-selection" class="btn-secondary">ğŸ“¤ LÆ°u vÃ¹ng chá»n</button>
          </div>
          <div id="index-status" class="status-message"></div>
        </div>
      </section>

      <section class="kb-section">
        <h2>Thá»‘ng kÃª kho dá»¯ liá»‡u</h2>
        <div id="kb-stats" class="kb-stats"><p>Äang táº£i...</p></div>
        <button id="refresh-stats" class="btn-secondary">ğŸ”„ LÃ m má»›i</button>
      </section>

      <section class="kb-section">
        <h2>TÃ¬m kiáº¿m nhanh trong kho</h2>
        <div class="search-form">
          <input type="text" id="kb-search-query" placeholder="Nháº­p tá»« khÃ³a tÃ¬m kiáº¿m..."/>
          <button id="kb-search-btn" class="btn-primary">ğŸ” TÃ¬m</button>
        </div>
        <div id="kb-search-results"></div>
      </section>
    </div>
  </div>
</body>
</html>
